export function authenticate(e,n){var r=JSON.parse(e),t=r.challenge;r.challenge=new Uint8Array(r.challenge),r.allowCredentials.forEach(function(e,n){r.allowCredentials[n].id=new Uint8Array(e.id)}),navigator.credentials.get({publicKey:r}).then(function(e){var r=[];new Uint8Array(e.rawId).forEach(function(e){r.push(e)});var a=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e.response.clientDataJSON))),i=[];new Uint8Array(e.response.clientDataJSON).forEach(function(e){i.push(e)});var o=[];new Uint8Array(e.response.authenticatorData).forEach(function(e){o.push(e)});var c=[];new Uint8Array(e.response.signature).forEach(function(e){c.push(e)});var l={type:e.type,originalChallenge:t,rawId:r,response:{authenticatorData:o,clientData:a,clientDataJSONarray:i,signature:c}};n(!0,JSON.stringify(l))}).catch(function(e){"name"in e&&("AbortError"==e.name||"NS_ERROR_ABORT"==e.name||"NotAllowedError"==e.name)?n(!1,"abort"):n(!1,e.toString())})}
export function register(e,n){(e=JSON.parse(e)).attestation=void 0,e.challenge=new Uint8Array(e.challenge),e.user.id=new Uint8Array(e.user.id),navigator.credentials.create({publicKey:e}).then(function(r){var t=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(r.response.clientDataJSON)));if("https://"+e.rp.id!=t.origin)return n(!1,"key returned something unexpected (1)");if(!("type"in t))return n(!1,"key returned something unexpected (2)");if("webauthn.create"!=t.type)return n(!1,"key returned something unexpected (3)");var a=[];new Uint8Array(r.response.attestationObject).forEach(function(e){a.push(e)});var i=[];new Uint8Array(r.rawId).forEach(function(e){i.push(e)});var o={rawId:i,id:r.id,type:r.type,response:{attestationObject:a,clientDataJSON:JSON.parse(String.fromCharCode.apply(null,new Uint8Array(r.response.clientDataJSON)))}};n(!0,JSON.stringify(o))}).catch(function(e){"name"in e&&("AbortError"==e.name||"NS_ERROR_ABORT"==e.name)||"NotAllowedError"==e.name?n(!1,"abort"):n(!1,e.toString())})}